import test from '@interactjs/_dev/test/test';
import * as utils from '@interactjs/utils';
import DropEvent from '../drop/DropEvent';
const dz1 = { target: 'dz1', fire(event) { this.fired = event; } };
const dz2 = { target: 'dz2', fire(event) { this.fired = event; } };
const el1 = Symbol('el1');
const el2 = Symbol('el2');
const interactable = Symbol('interactable');
const dragElement = Symbol('drag-el');
test('DropEvent constructor', (t) => {
    const interaction = { dropState: {} };
    const dragEvent = Object.freeze({ interaction, interactable, target: dragElement, timeStamp: 10 });
    utils.extend(interaction.dropState, {
        activeDrops: [
            { dropzone: dz1, element: el1 },
            { dropzone: dz2, element: el2 },
        ],
        cur: { dropzone: dz1, element: el1 },
        prev: { dropzone: dz2, element: el2 },
        events: {},
    });
    const dropmove = new DropEvent(interaction.dropState, dragEvent, 'dropmove');
    t.equal(dropmove.target, el1, 'dropmove uses dropState.cur.element');
    t.equal(dropmove.dropzone, dz1, 'dropmove uses dropState.cur.dropzone');
    t.equal(dropmove.relatedTarget, dragElement);
    const dragleave = new DropEvent(interaction.dropState, dragEvent, 'dragleave');
    t.equal(dragleave.target, el2, 'dropmove uses dropState.prev.element');
    t.equal(dragleave.dropzone, dz2, 'dropmove uses dropState.prev.dropzone');
    t.equal(dragleave.relatedTarget, dragElement);
    t.end();
});
test('DropEvent.reject()', (t) => {
    const interaction = { dropState: {} };
    const dragEvent = Object.freeze({ interaction, interactable, target: dragElement, timeStamp: 10 });
    utils.extend(interaction.dropState, {
        activeDrops: [
            { dropzone: dz1, element: el1 },
            { dropzone: dz2, element: el2 },
        ],
        cur: { dropzone: null, element: null },
        prev: { dropzone: null, element: null },
        events: {},
    });
    const dropactivate = new DropEvent(interaction.dropState, dragEvent, 'dropactivate');
    dropactivate.dropzone = dz1;
    dropactivate.target = el1;
    dropactivate.reject();
    t.ok(dropactivate.propagationStopped && dropactivate.immediatePropagationStopped, 'rejected event propagation is stopped');
    t.equal(dz1.fired.type, 'dropdeactivate', 'dropdeactivate is fired on rejected dropzone');
    t.deepEqual(interaction.dropState.activeDrops, [{ dropzone: dz2, element: el2 }], 'activeDrop of rejected dropactivate event is removed');
    t.deepEqual(interaction.dropState.cur, { dropzone: null, element: null }, 'dropState.cur dropzone and element are set to null after rejecting dropactivate');
    utils.extend(interaction.dropState, {
        cur: { dropzone: dz1, element: el1 },
        prev: { dropzone: null, element: null },
        events: {},
    });
    const dropmove = new DropEvent(interaction.dropState, dragEvent, 'dropmove');
    dropmove.reject();
    t.deepEqual(interaction.dropState.cur, { dropzone: dz1, element: el1 }, 'dropState.cur remains the same after rejecting non activate event');
    t.ok(interaction.dropState.rejected, 'dropState.rejected === true');
    t.equal(dz1.fired.type, 'dragleave', 'dragleave is fired on rejected dropzone');
    t.end();
});
test('DropEvent.stop[Immediate]Propagation()', (t) => {
    const dropEvent = new DropEvent({ cur: {} }, {}, 'dragmove');
    t.notOk(dropEvent.propagationStopped || dropEvent.immediatePropagationStopped);
    dropEvent.stopPropagation();
    t.ok(dropEvent.propagationStopped);
    t.notOk(dropEvent.immediatePropagationStopped);
    dropEvent.propagationStopped = false;
    dropEvent.stopImmediatePropagation();
    t.ok(dropEvent.propagationStopped && dropEvent.immediatePropagationStopped);
    t.end();
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRHJvcEV2ZW50LnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJEcm9wRXZlbnQuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLElBQUksTUFBTSw0QkFBNEIsQ0FBQTtBQUM3QyxPQUFPLEtBQUssS0FBSyxNQUFNLG1CQUFtQixDQUFBO0FBQzFDLE9BQU8sU0FBUyxNQUFNLG1CQUFtQixDQUFBO0FBRXpDLE1BQU0sR0FBRyxHQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUUsS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFBLENBQUMsQ0FBQyxFQUFFLENBQUE7QUFDdkUsTUFBTSxHQUFHLEdBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBRSxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtBQUN2RSxNQUFNLEdBQUcsR0FBUSxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDOUIsTUFBTSxHQUFHLEdBQVEsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQzlCLE1BQU0sWUFBWSxHQUFRLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQTtBQUNoRCxNQUFNLFdBQVcsR0FBUSxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUE7QUFFMUMsSUFBSSxDQUFDLHVCQUF1QixFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUU7SUFDbEMsTUFBTSxXQUFXLEdBQVEsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFLENBQUE7SUFDMUMsTUFBTSxTQUFTLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQTtJQUVsRyxLQUFLLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUU7UUFDbEMsV0FB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QUFFRixJQUFJLENBQUMsd0NBQXdDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNuRCxNQUFNLFNBQVMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQVMsRUFBRSxFQUFFLEVBQUUsVUFBVSxDQUFDLENBQUE7SUFFbkUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsa0JBQWtCLElBQUksU0FBUyxDQUFDLDJCQUEyQixDQUFDLENBQUE7SUFFOUUsU0FBUyxDQUFDLGVBQWUsRUFBRSxDQUFBO0lBQzNCLENBQUMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLENBQUE7SUFDbEMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsMkJBQTJCLENBQUMsQ0FBQTtJQUU5QyxTQUFTLENBQUMsa0JBQWtCLEdBQUcsS0FBSyxDQUFBO0lBRXBDLFNBQVMsQ0FBQyx3QkFBd0IsRUFBRSxDQUFBO0lBQ3BDLENBQUMsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLGtCQUFrQixJQUFJLFNBQVMsQ0FBQywyQkFBMkIsQ0FBQyxDQUFBO0lBRTNFLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtBQUNULENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHRlc3QgZnJvbSAnQGludGVyYWN0anMvX2Rldi90ZXN0L3Rlc3QnXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICdAaW50ZXJhY3Rqcy91dGlscydcbmltcG9ydCBEcm9wRXZlbnQgZnJvbSAnLi4vZHJvcC9Ecm9wRXZlbnQnXG5cbmNvbnN0IGR6MTogYW55ID0geyB0YXJnZXQ6ICdkejEnLCBmaXJlIChldmVudCkgeyB0aGlzLmZpcmVkID0gZXZlbnQgfSB9XG5jb25zdCBkejI6IGFueSA9IHsgdGFyZ2V0OiAnZHoyJywgZmlyZSAoZXZlbnQpIHsgdGhpcy5maXJlZCA9IGV2ZW50IH0gfVxuY29uc3QgZWwxOiBhbnkgPSBTeW1ib2woJ2VsMScpXG5jb25zdCBlbDI6IGFueSA9IFN5bWJvbCgnZWwyJylcbmNvbnN0IGludGVyYWN0YWJsZTogYW55ID0gU3ltYm9sKCdpbnRlcmFjdGFibGUnKVxuY29uc3QgZHJhZ0VsZW1lbnQ6IGFueSA9IFN5bWJvbCgnZHJhZy1lbCcpXG5cbnRlc3QoJ0Ryb3BFdmVudCBjb25zdHJ1Y3RvcicsICh0KSA9PiB7XG4gIGNvbnN0IGludGVyYWN0aW9uOiBhbnkgPSB7IGRyb3BTdGF0ZToge30gfVxuICBjb25zdCBkcmFnRXZlbnQgPSBPYmplY3QuZnJlZXplKHsgaW50ZXJhY3Rpb24sIGludGVyYWN0YWJsZSwgdGFyZ2V0OiBkcmFnRWxlbWVudCwgdGltZVN0YW1wOiAxMCB9KVxuXG4gIHV0aWxzLmV4dGVuZChpbnRlcmFjdGlvbi5kcm9wU3RhdGUsIHtcbiAgICBhY3RpdmVEcm9wczogW1xuICAgICAgeyBkcm9wem9uZTogZHoxLCBlbGVtZW50OiBlbDEgfSxcbiAgICAgIHsgZHJvcHpvbmU6IGR6MiwgZWxlbWVudDogZWwyIH0sXG4gICAgXSxcbiAgICBjdXIgOiB7IGRyb3B6b25lOiBkejEsIGVsZW1lbnQ6IGVsMSB9LFxuICAgIHByZXY6IHsgZHJvcHpvbmU6IGR6MiwgZWxlbWVudDogZWwyIH0sXG4gICAgZXZlbnRzOiB7fSxcbiAgfSlcblxuICBjb25zdCBkcm9wbW92ZSA9IG5ldyBEcm9wRXZlbnQoaW50ZXJhY3Rpb24uZHJvcFN0YXRlLCBkcmFnRXZlbnQsICdkcm9wbW92ZScpXG5cbiAgdC5lcXVhbChkcm9wbW92ZS50YXJnZXQsIGVsMSwgJ2Ryb3Btb3ZlIHVzZXMgZHJvcFN0YXRlLmN1ci5lbGVtZW50JylcbiAgdC5lcXVhbChkcm9wbW92ZS5kcm9wem9uZSwgZHoxLCAnZHJvcG1vdmUgdXNlcyBkcm9wU3RhdGUuY3VyLmRyb3B6b25lJylcbiAgdC5lcXVhbChkcm9wbW92ZS5yZWxhdGVkVGFyZ2V0LCBkcmFnRWxlbWVudClcblxuICBjb25zdCBkcmFnbGVhdmUgPSBuZXcgRHJvcEV2ZW50KGludGVyYWN0aW9uLmRyb3BTdGF0ZSwgZHJhZ0V2ZW50LCAnZHJhZ2xlYXZlJylcblxuICB0LmVxdWFsKGRyYWdsZWF2ZS50YXJnZXQsIGVsMiwgJ2Ryb3Btb3ZlIHVzZXMgZHJvcFN0YXRlLnByZXYuZWxlbWVudCcpXG4gIHQuZXF1YWwoZHJhZ2xlYXZlLmRyb3B6b25lLCBkejIsICdkcm9wbW92ZSB1c2VzIGRyb3BTdGF0ZS5wcmV2LmRyb3B6b25lJylcbiAgdC5lcXVhbChkcmFnbGVhdmUucmVsYXRlZFRhcmdldCwgZHJhZ0VsZW1lbnQpXG5cbiAgdC5lbmQoKVxufSlcblxudGVzdCgnRHJvcEV2ZW50LnJlamVjdCgpJywgKHQpID0+IHtcbiAgY29uc3QgaW50ZXJhY3Rpb246IGFueSA9IHsgZHJvcFN0YXRlOiB7fSB9XG4gIGNvbnN0IGRyYWdFdmVudCA9IE9iamVjdC5mcmVlemUoeyBpbnRlcmFjdGlvbiwgaW50ZXJhY3RhYmxlLCB0YXJnZXQ6IGRyYWdFbGVtZW50LCB0aW1lU3RhbXA6IDEwIH0pXG5cbiAgdXRpbHMuZXh0ZW5kKGludGVyYWN0aW9uLmRyb3BTdGF0ZSwge1xuICAgIGFjdGl2ZURyb3BzOiBbXG4gICAgICB7IGRyb3B6b25lOiBkejEsIGVsZW1lbnQ6IGVsMSB9LFxuICAgICAgeyBkcm9wem9uZTogZHoyLCBlbGVtZW50OiBlbDIgfSxcbiAgICBdLFxuICAgIGN1ciA6IHsgZHJvcHpvbmU6IG51bGwsIGVsZW1lbnQ6IG51bGwgfSxcbiAgICBwcmV2OiB7IGRyb3B6b25lOiBudWxsLCBlbGVtZW50OiBudWxsIH0sXG4gICAgZXZlbnRzOiB7fSxcbiAgfSlcblxuICBjb25zdCBkcm9wYWN0aXZhdGUgPSBuZXcgRHJvcEV2ZW50KGludGVyYWN0aW9uLmRyb3BTdGF0ZSwgZHJhZ0V2ZW50LCAnZHJvcGFjdGl2YXRlJylcblxuICBkcm9wYWN0aXZhdGUuZHJvcHpvbmUgPSBkejFcbiAgZHJvcGFjdGl2YXRlLnRhcmdldCA9IGVsMVxuICBkcm9wYWN0aXZhdGUucmVqZWN0KClcblxuICB0Lm9rKGRyb3BhY3RpdmF0ZS5wcm9wYWdhdGlvblN0b3BwZWQgJiYgZHJvcGFjdGl2YXRlLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCxcbiAgICAncmVqZWN0ZWQgZXZlbnQgcHJvcGFnYXRpb24gaXMgc3RvcHBlZCcpXG5cbiAgdC5lcXVhbChkejEuZmlyZWQudHlwZSwgJ2Ryb3BkZWFjdGl2YXRlJywgJ2Ryb3BkZWFjdGl2YXRlIGlzIGZpcmVkIG9uIHJlamVjdGVkIGRyb3B6b25lJylcblxuICB0LmRlZXBFcXVhbChcbiAgICBpbnRlcmFjdGlvbi5kcm9wU3RhdGUuYWN0aXZlRHJvcHMsXG4gICAgW3sgZHJvcHpvbmU6IGR6MiwgZWxlbWVudDogZWwyIH1dLFxuICAgICdhY3RpdmVEcm9wIG9mIHJlamVjdGVkIGRyb3BhY3RpdmF0ZSBldmVudCBpcyByZW1vdmVkJylcblxuICB0LmRlZXBFcXVhbChcbiAgICBpbnRlcmFjdGlvbi5kcm9wU3RhdGUuY3VyLFxuICAgIHsgZHJvcHpvbmU6IG51bGwsIGVsZW1lbnQ6IG51bGwgfSxcbiAgICAnZHJvcFN0YXRlLmN1ciBkcm9wem9uZSBhbmQgZWxlbWVudCBhcmUgc2V0IHRvIG51bGwgYWZ0ZXIgcmVqZWN0aW5nIGRyb3BhY3RpdmF0ZScpXG5cbiAgdXRpbHMuZXh0ZW5kKGludGVyYWN0aW9uLmRyb3BTdGF0ZSwge1xuICAgIGN1ciA6IHsgZHJvcHpvbmU6IGR6MSwgZWxlbWVudDogZWwxIH0sXG4gICAgcHJldjogeyBkcm9wem9uZTogbnVsbCwgZWxlbWVudDogbnVsbCB9LFxuICAgIGV2ZW50czoge30sXG4gIH0pXG5cbiAgY29uc3QgZHJvcG1vdmUgPSBuZXcgRHJvcEV2ZW50KGludGVyYWN0aW9uLmRyb3BTdGF0ZSwgZHJhZ0V2ZW50LCAnZHJvcG1vdmUnKVxuXG4gIGRyb3Btb3ZlLnJlamVjdCgpXG5cbiAgdC5kZWVwRXF1YWwoXG4gICAgaW50ZXJhY3Rpb24uZHJvcFN0YXRlLmN1cixcbiAgICB7IGRyb3B6b25lOiBkejEsIGVsZW1lbnQ6IGVsMSB9LFxuICAgICdkcm9wU3RhdGUuY3VyIHJlbWFpbnMgdGhlIHNhbWUgYWZ0ZXIgcmVqZWN0aW5nIG5vbiBhY3RpdmF0ZSBldmVudCcpXG5cbiAgdC5vayhpbnRlcmFjdGlvbi5kcm9wU3RhdGUucmVqZWN0ZWQsICdkcm9wU3RhdGUucmVqZWN0ZWQgPT09IHRydWUnKVxuXG4gIHQuZXF1YWwoZHoxLmZpcmVkLnR5cGUsICdkcmFnbGVhdmUnLCAnZHJhZ2xlYXZlIGlzIGZpcmVkIG9uIHJlamVjdGVkIGRyb3B6b25lJylcblxuICB0LmVuZCgpXG59KVxuXG50ZXN0KCdEcm9wRXZlbnQuc3RvcFtJbW1lZGlhdGVdUHJvcGFnYXRpb24oKScsICh0KSA9PiB7XG4gIGNvbnN0IGRyb3BFdmVudCA9IG5ldyBEcm9wRXZlbnQoeyBjdXI6IHt9IH0gYXMgYW55LCB7fSwgJ2RyYWdtb3ZlJylcblxuICB0Lm5vdE9rKGRyb3BFdmVudC5wcm9wYWdhdGlvblN0b3BwZWQgfHwgZHJvcEV2ZW50LmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZClcblxuICBkcm9wRXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcbiAgdC5vayhkcm9wRXZlbnQucHJvcGFnYXRpb25TdG9wcGVkKVxuICB0Lm5vdE9rKGRyb3BFdmVudC5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQpXG5cbiAgZHJvcEV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCA9IGZhbHNlXG5cbiAgZHJvcEV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpXG4gIHQub2soZHJvcEV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCAmJiBkcm9wRXZlbnQuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKVxuXG4gIHQuZW5kKClcbn0pXG4iXX0=